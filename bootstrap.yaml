---
apiVersion: v1
kind: Service
metadata:
  name: "wkndr-app"
spec:
  ports:
  - port: 8080
    name: apache2
    protocol: TCP
  - port: 5000
    name: docker-registry
    protocol: TCP
  selector:
    name: "wkndr-app"
...
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: wkndr-app
  labels:
    app: wkndr-app
spec:
  revisionHistoryLimit: 1
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 0
  replicas: 1
  template:
    metadata:
      labels:
        name: wkndr-app
      annotations:
    spec:
      #serviceAccountName: rutty
      volumes:
      #- name: {{ print . "-config-volume" }}
      #  configMap:
      #    name: {{ print . "-ok-go-config" }}
      containers:
      - name: wkndr-app
        image: wkndr:latest
        imagePullPolicy: IfNotPresent
        resources:
          requests:
            memory: 500Mi
            cpu: 500m
          limits:
            memory: 1000Mi
            cpu: 2000m
        volumeMounts:
        #- name: {{ print . "-config-volume" }}
        #  mountPath: {{ print "/home/app/current/config/run.d/" . }}
        ports:
        - containerPort: 8080
        - containerPort: 5000
        command: ["/usr/bin/wkndr", "dev", "/usr/lib/wkndr/Procfile.init"]
        env:
        #- name: HOME
        #  value: "/var/tmp/workspace.git"
